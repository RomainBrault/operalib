

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Module Quantile &mdash; Operalib 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Operalib
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">General examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference_papers/index.html">Reference papers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Operalib</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Module Quantile</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/modules/quantile.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-quantile">
<h1>Module Quantile<a class="headerlink" href="#module-quantile" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-operalib.quantile"></span><p><a class="reference internal" href="#module-operalib.quantile" title="operalib.quantile"><code class="xref py py-mod docutils literal notranslate"><span class="pre">operalib.quantile</span></code></a> implements joint quantile regression with
Operator-Valued Kernels.</p>
<dl class="class">
<dt id="operalib.quantile.Quantile">
<em class="property">class </em><code class="descclassname">operalib.quantile.</code><code class="descname">Quantile</code><span class="sig-paren">(</span><em>kernel='DGauss'</em>, <em>probs=0.5</em>, <em>lbda=1e-05</em>, <em>gamma=None</em>, <em>gamma_quantile=0.0</em>, <em>eps=0.0</em>, <em>tol=None</em>, <em>nc_const=False</em>, <em>kernel_params=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/operalib/quantile.html#Quantile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#operalib.quantile.Quantile" title="Permalink to this definition">¶</a></dt>
<dd><p>Joint quantile regression with operator-valued kernels.
Joint quantile regression enables to learn and predict simultaneously
several conditional quantiles (for prescribed quantile levels). Following
the seminal work by Koenker and Basset (1978), the method minimizes an
empirical risk based on the pinball loss and a squared-norm regularization.
The hypothesis space considered here is the reproducing kernel Hilbert
space generated by an operator-valued kernel chosen by the practitioner.</p>
<p class="rubric">References</p>
<ul class="simple">
<li>R. Koenker and G. Bassett
“Regression Quantiles”, Econometrica, 46(1):33-50, 1978.</li>
<li>R. Koenker
“Quantile Regression”, Cambridge University Press, Cambridge, New York,
2005.</li>
<li>M. Sangnier, O. Fercoq and F. d’Alche-Buc
“Joint quantile regression in vector-valued RKHSs.” In Advances in Neural</li>
</ul>
<dl class="docutils">
<dt>operalib.Ridge</dt>
<dd>Operator-Valued kernel ridge regression</dd>
<dt>sklearn.Ridge</dt>
<dd>Linear ridge regression.</dd>
<dt>sklearn.KernelRidge</dt>
<dd>Kernel ridge regression.</dd>
<dt>sklearn.SVR</dt>
<dd>Support Vector Regression implemented using libsvm.</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">operalib</span> <span class="k">as</span> <span class="nn">ovk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_samples</span><span class="p">,</span> <span class="n">n_features</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quantile_levels</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reg</span> <span class="o">=</span> <span class="n">ovk</span><span class="o">.</span><span class="n">Quantile</span><span class="p">(</span><span class="s1">&#39;DGauss&#39;</span><span class="p">,</span> <span class="n">lbda</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  
<span class="go">Quantile(gamma=None, gamma_quantile=0.0, kernel=&#39;DGauss&#39;,</span>
<span class="go">    kernel_params=None, lbda=1.0, nc_const=False, probs=0.5, tol=None,</span>
<span class="go">    verbose=False)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attributes:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><dl class="first last docutils">
<dt>coefs <span class="classifier-delimiter">:</span> <span class="classifier">{array-like}, shape [n_samples*n_probs, 1]</span></dt>
<dd><p class="first last">Dual coefficients of the kernel machine</p>
</dd>
<dt>intercept <span class="classifier-delimiter">:</span> <span class="classifier">{array-like}, shape [n_probs]</span></dt>
<dd><p class="first last">Vector of intercepts</p>
</dd>
</dl>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#operalib.quantile.Quantile.fit" title="operalib.quantile.Quantile.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(X,&nbsp;y)</td>
<td>Fit joint quantile regression model.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#operalib.quantile.Quantile.get_params" title="operalib.quantile.Quantile.get_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code></a>([deep])</td>
<td>Get parameters for this estimator.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#operalib.quantile.Quantile.pinball_loss" title="operalib.quantile.Quantile.pinball_loss"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pinball_loss</span></code></a>(y_true,&nbsp;y_pred,&nbsp;probs)</td>
<td>Compute the pinball loss.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#operalib.quantile.Quantile.predict" title="operalib.quantile.Quantile.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(X)</td>
<td>Predict conditional quantiles.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#operalib.quantile.Quantile.score" title="operalib.quantile.Quantile.score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">score</span></code></a>(X,&nbsp;y[,&nbsp;sample_weight])</td>
<td>Compute the pinball score for the given dataset.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#operalib.quantile.Quantile.set_params" title="operalib.quantile.Quantile.set_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code></a>(**params)</td>
<td>Set the parameters of this estimator.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="operalib.quantile.Quantile.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/operalib/quantile.html#Quantile.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#operalib.quantile.Quantile.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit joint quantile regression model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>inputs</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{array-like, sparse matrix}, shape = [n_samples, n_features]</span></dt>
<dd><p class="first last">Training data.</p>
</dd>
<dt><strong>targets</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{array-like}, shape = [n_samples]</span></dt>
<dd><p class="first last">Target values.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>self</strong> <span class="classifier-delimiter">:</span> <span class="classifier">returns an instance of self.</span></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="operalib.quantile.Quantile.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>deep=True</em><span class="sig-paren">)</span><a class="headerlink" href="#operalib.quantile.Quantile.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameters for this estimator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>deep</strong> <span class="classifier-delimiter">:</span> <span class="classifier">boolean, optional</span></dt>
<dd><p class="first last">If True, will return the parameters for this estimator and
contained subobjects that are estimators.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>params</strong> <span class="classifier-delimiter">:</span> <span class="classifier">mapping of string to any</span></dt>
<dd><p class="first last">Parameter names mapped to their values.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="operalib.quantile.Quantile.pinball_loss">
<em class="property">static </em><code class="descname">pinball_loss</code><span class="sig-paren">(</span><em>y_true</em>, <em>y_pred</em>, <em>probs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/operalib/quantile.html#Quantile.pinball_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#operalib.quantile.Quantile.pinball_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the pinball loss.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>pred</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{array-like}, shape = [n_quantiles, n_samples] or [n_samples]</span></dt>
<dd><p class="first last">Predictions.</p>
</dd>
<dt><strong>y</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{array-like}, shape = [n_samples]</span></dt>
<dd><p class="first last">Targets.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>l</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{array}, shape = [n_quantiles]</span></dt>
<dd><p class="first last">Average loss for each quantile level.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="operalib.quantile.Quantile.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/operalib/quantile.html#Quantile.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#operalib.quantile.Quantile.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict conditional quantiles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>X</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{array-like, sparse matrix}, shape = [n_samples, n_features]</span></dt>
<dd><p class="first last">Samples.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>y</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{array}, shape = [n_samples, n_quantiles]</span></dt>
<dd><p class="first last">Returns predicted values for each prescribed quantile level.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="operalib.quantile.Quantile.score">
<code class="descname">score</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>sample_weight=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/operalib/quantile.html#Quantile.score"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#operalib.quantile.Quantile.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the pinball score for the given dataset.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>X</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{array-like, sparse matrix}, shape = [n_samples, n_features]</span></dt>
<dd><p class="first last">Training data.</p>
</dd>
<dt><strong>y</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{array-like}, shape = [n_samples]</span></dt>
<dd><p class="first last">Target values.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>l</strong> <span class="classifier-delimiter">:</span> <span class="classifier">{float}</span></dt>
<dd><p class="first last">Average pinball score (the higher, the better).</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="operalib.quantile.Quantile.set_params">
<code class="descname">set_params</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="headerlink" href="#operalib.quantile.Quantile.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The latter have parameters of the form
<code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s possible to update each
component of a nested object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>self</strong></dt>
<dd></dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Romain Brault.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>